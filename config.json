{
  "sources": [
    {
      "path": "sample_logs/apache_access.log",
      "type": "apache"
    },
    {
      "path": "sample_logs/auth.log",
      "type": "ssh"
    }
  ],
  "rules": [
    {
      "id": "HTTP_401",
      "type": "apache",
      "pattern": "\\s401\\s",
      "description": "HTTP 401 Unauthorized detected",
      "severity": "medium"
    },
    {
      "id": "HTTP_403",
      "type": "apache",
      "pattern": "\\s403\\s",
      "description": "HTTP 403 Forbidden detected",
      "severity": "high"
    },
    {
      "id": "SSH_FAIL",
      "type": "ssh",
      "pattern": "Failed password for (invalid user )?([\\w\\-]+) from (\\d+\\.\\d+\\.\\d+\\.\\d+)",
      "description": "Failed SSH login",
      "severity": "high",
      "extract": [
        "user",
        "ip"
      ]
    },
    {
      "id": "SSH_ROOT_LOGIN",
      "type": "ssh",
      "pattern": "Accepted password for root from (\\d+\\.\\d+\\.\\d+\\.\\d+)",
      "description": "Root login detected",
      "severity": "critical",
      "extract": [
        "ip"
      ]
    }
  ],
  "thresholds": [
    {
      "name": "SSH_FAIL_per_ip_per_5min",
      "rule_id": "SSH_FAIL",
      "group_by": "ip",
      "window_minutes": 5,
      "count": 5,
      "action": "ALERT"
    }
  ]
}